Metadata-Version: 2.4
Name: promopulse-api
Version: 0.1.0
Summary: PromoPulse API â€“ Promotion & Engagement Platform
Author-email: PromoPulse Team <dev@promopulse.local>
License: MIT
Requires-Python: >=3.12
Description-Content-Type: text/markdown
Requires-Dist: fastapi
Requires-Dist: uvicorn[standard]
Requires-Dist: pydantic-settings
Requires-Dist: python-dotenv
Requires-Dist: sqlalchemy[asyncio]
Requires-Dist: asyncpg
Requires-Dist: alembic
Provides-Extra: dev
Requires-Dist: pytest; extra == "dev"
Requires-Dist: pytest-asyncio; extra == "dev"
Requires-Dist: httpx; extra == "dev"
Requires-Dist: black; extra == "dev"
Requires-Dist: ruff; extra == "dev"

# PromoPulse API â€“ Promotion & Engagement Platform (Python + FastAPI)

PromoPulse is a backend service built with **Python**, designed for managing **promotional campaigns**, **user subscriptions**, and **event engagement tracking** (views, clicks, redemptions, etc.).  
This project emphasizes **real-world engineering skills** through:

- Robust **relational modeling** (PostgreSQL)
- Clean and maintainable **REST API architecture**
- **Asynchronous processing** with idempotency
- **Event queue + DLQ + retries**
- **Security applied to PII** (encryption)
- **Testing and mocking in depth**
- **Data structures** (hash maps, queues) used for efficient tracking

> The project is intentionally structured as a **professional portfolio repository**, showcasing practical engineering decisions over academic abstractions.

---

## ğŸš€ Features

| Feature | Description |
|--------|-------------|
| ğŸ‘¥ Users | Create users with encrypted personal data (PII) |
| ğŸ¯ Promotions | Manage marketing campaigns (active, draft, ended) |
| ğŸ” Subscriptions | Link users to promotions with validation rules |
| ğŸ“Š Events | Receive and process engagement events (VIEW, CLICK, REDEEM) |
| ğŸ§¾ Idempotency | Prevent duplicated event processing |
| ğŸª£ DLQ & Retry | Failed events are retried, then sent to a Dead Letter Queue |
| ğŸ“ˆ Stats | Fast engagement analytics using in-memory hash maps |
| ğŸ”’ PII Security | Encrypt email and phone fields before persisting |
| ğŸ§® Algorithms | Sliding window rate-limiting + dict aggregation |

---

## ğŸ§± Tech Stack

| Category | Technology |
|----------|------------|
| Language | Python 3.12+
| Web Framework | FastAPI (async)
| Database | PostgreSQL + SQLAlchemy (async) + Alembic
| Messaging | In-memory queue (optional: Redis or AWS SQS)
| Testing | pytest, pytest-asyncio, httpx, unittest.mock
| Encryption | cryptography (Fernet)
| Containerization | Docker + Docker Compose
| Optional Serverless | FastAPI on AWS Lambda via Mangum

---

## ğŸ“ Architecture Overview

promopulse/ app/ api/                # Routers core/               # Config, Security (PII Encryption) db/                 # Models, Session, Migrations domain/             # Business rules (Entities + Services) infrastructure/     # Repositories, Queue, Workers tests/                # Unit + Integration docker/               # Compose / Dockerfile README.md

ğŸ§  **Design Principles**
- Clean organization by domain
- Async-first DB and API
- Small, testable services
- Real data flows (queue â†’ worker â†’ DB)

---

## ğŸ—ƒï¸ Database Modeling

### ğŸ”¹ Entities

| Table | Purpose |
|-------|---------|
| `users` | PII encrypted | 
| `promotions` | Campaign definitions |
| `subscriptions` | Links users to promotions |
| `events` | Incoming engagement events |
| `processed_events` | Idempotency record |
| `dead_letter_events` | Failed events after retries |

ğŸ“Œ Indexes added for subscription lookup, event aggregation, and idempotency.

---

## ğŸ§µ Event Processing Flow

1. Client sends event to `POST /events/ingest`.
2. If already processed (idempotency check) â†’ **return 200**.
3. Else â†’ event enters queue.
4. Worker consumes and:
   - Updates stats (hash map aggregation)
   - Persists data
5. On failure:
   - Retries controlled
   - If retries exhausted â†’ moves to DLQ

ğŸ“Œ **Rate limiting** is implemented using a **sliding window + deque** per subscription.

---

## ğŸ” Security Applied

- AES-based encryption of PII fields
- Private key via environment variables (KMS-like workflow)
- Safe serialization/deserialization
- JWT support can be added as optional module

---

## ğŸ§ª Testing Strategy

| Test Type | Focus |
|----------|-------|
| Unit | Domain logic, rate limiting, idempotency |
| Integration | End-to-end event ingestion + DB operations |
| Mocking | Fakes for queues, workers, encryption |
| API | Contract tests with httpx |

---

## ğŸ³ Running the Project

### **Requirements**
- Docker & Docker Compose
- Python 3.12+

### **Setup**

```bash
git clone https://github.com/YOUR_USERNAME/promopulse-api.git
cd promopulse-api
docker-compose up -d
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -e .
alembic upgrade head
uvicorn app.main:app --reload

ğŸ“Œ Swagger UI: http://localhost:8000/docs
